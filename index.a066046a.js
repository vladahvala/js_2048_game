const e=new class{constructor(e){void 0!==e?this.initialState=e:this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.board=this.initialState.map(e=>[...e]),this.score=0,this.status="idle"}updateCell(e,t,s){let r=document.querySelectorAll(".field-row")[e].children[t];r.textContent=0===s?"":s,r.className="field-cell",0!==s&&r.classList.add(`field-cell--${s}`)}updateDOM(){for(let e=0;e<4;e++)for(let t=0;t<4;t++){let s=this.board[e][t];this.updateCell(e,t,s)}let e=document.querySelector(".game-score");e&&(e.textContent=this.score)}merge(e){let t=Array(e.length).fill(!1);for(let s=0;s<e.length-1;s++)e[s]!==e[s+1]||t[s]||t[s+1]||(e[s]*=2,this.score+=e[s],e.splice(s+1,1),t.splice(s+1,1),t[s]=!0);return e}getNonZeroRow(e){return this.board[e].filter(e=>0!==e)}getNonZeroCol(e){return this.board.map(t=>t[e]).filter(e=>0!==e)}padCells(e){for(;e.length<4;)e.push(0)}move(e){let t="left"===e||"right"===e,s="right"===e||"down"===e;for(let e=0;e<4;e++){let r=t?this.getNonZeroRow(e):this.getNonZeroCol(e);s&&r.reverse(),r=this.merge(r),this.padCells(r),s&&r.reverse();for(let s=0;s<4;s++)t?this.board[e][s]=r[s]:this.board[s][e]=r[s]}this.updateDOM()}showMessage(e){let t={win:document.querySelector(".message-win"),lose:document.querySelector(".message-lose"),start:document.querySelector(".message-start")};Object.keys(t).forEach(s=>{s===e?t[s].classList.remove("hidden"):t[s].classList.add("hidden")})}checkWin(){for(let e of this.board)if(e.includes(2048))return this.status="win",this.showMessage("win"),!0;return!1}checkLose(){for(let e=0;e<this.board.length;e++)for(let t=0;t<this.board[e].length;t++)if(0===this.board[e][t])return!1;return this.status="lose",this.showMessage("lose"),!0}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}addNewCell(){let e=[];for(let t=0;t<this.board.length;t++)for(let s=0;s<this.board[t].length;s++)0===this.board[t][s]&&e.push([t,s]);let t=Math.floor(Math.random()*e.length),[s,r]=e[t],o=.9>Math.random()?2:4;this.board[s][r]=o,this.updateCell(s,r,o)}start(){this.status="playing";let e=document.querySelector(".message-container .message-win"),t=document.querySelector(".message-container .message-start"),s=document.querySelector(".message-container .message-lose");t.classList.add("hidden"),s.classList.add("hidden"),e.classList.add("hidden");let r=document.querySelector("button.start");r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart",this.addNewCell(),this.addNewCell()}restart(){this.board=this.initialState.map(e=>[...e]),this.score=0,this.status="idle";let e=document.querySelectorAll(".field-row");for(let t=0;t<4;t++)for(let s=0;s<4;s++){let r=e[t].children[s];r.textContent="",r.className="field-cell"}this.showMessage("start");let t=document.querySelector("button.restart");t&&(t.classList.remove("restart"),t.classList.add("start"),t.textContent="Start")}},t=document.querySelector(".controls button");function s(t){let s=e.getState().map(e=>[...e]);t();let r=s.some((t,s)=>t.some((t,r)=>t!==e.getState()[s][r]));r&&!e.checkWin()&&e.addNewCell(),r||e.checkLose()}t.addEventListener("click",()=>{t.classList.contains("start")?e.start():t.classList.contains("restart")&&e.restart()}),document.addEventListener("keydown",t=>{switch(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&t.preventDefault(),t.key){case"ArrowLeft":s(()=>e.move("left"));break;case"ArrowRight":s(()=>e.move("right"));break;case"ArrowUp":s(()=>e.move("up"));break;case"ArrowDown":s(()=>e.move("down"))}});
//# sourceMappingURL=index.a066046a.js.map
